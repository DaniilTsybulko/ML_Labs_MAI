# Результат работы моделей машинного обучения рекомендательных сисетм 

## Описание 
Реализованы две модели:
1. **UserKNN** — для персонализированных рекомендаций на основе пользовательской истории оценок.
2. **Content-based** — для поиска фильмов и формирования рекомендаций к конкретному фильму на основе его содержимого.

## Датасет
Датасет **MovieLens 100k** содержит:
- 100,000 оценок фильмов от 943 пользователей для 1,682 фильмов.
- Оценки от 1 до 5.
- Дополнительные данные: жанры фильмов, год выпуска, названия.

Данный датасет универсален для задач рекомендаций, так как включает как пользовательские рейтинги, так и контентную информацию о фильмах.

## Реализованные модели

### 1. UserKNN (Коллаборативная фильтрация)
#### Описание
UserKNN — метод, который находит схожих пользователей (соседей) на основе их рейтингов фильмов. Рекомендации генерируются на основе предпочтений ближайших соседей.  

#### Почему UserKNN?
- **Обоснование выбора**:
  - Модель учитывает реальное поведение пользователей, что позволяет генерировать персонализированные рекомендации.
  - Простота интерпретации: можно объяснить пользователю, почему фильм попал в список рекомендаций.
- **Особенности**:
  - Эффективна для активных пользователей с богатой историей взаимодействий.
  - Лучше подходит для ситуаций, когда данных о содержимом фильмов недостаточно или они неполные.

#### Метрика оценки: NDCG@10
- **Почему NDCG?**
  - NDCG (Normalized Discounted Cumulative Gain) учитывает не только релевантность, но и порядок фильмов в списке рекомендаций.
  - Фокус на топ-10 рекомендациях соответствует реальным ожиданиям пользователей, которые чаще всего обращают внимание только на первые позиции.

#### Результат
- **NDCG@10 = 0.8465** — высокая релевантность рекомендаций.

### 2. Content-based (Контентная фильтрация)
#### Описание
Content-based модель использует метаданные фильмов (жанры, описание, год выпуска) для вычисления их сходства.  
Метод TF-IDF применялся для анализа текстовых данных (например, описаний фильмов), а сходство определялось с использованием косинусной меры.  

#### Задача: Рекомендации при поиске
- **Сценарий использования**:
  - Пользователь ищет фильм (например, по названию или ключевым словам).
  - Content-based модель предлагает топ-10 фильмов, схожих с найденным.
  - Это позволяет не только найти нужный фильм, но и предложить релевантные альтернативы, например, из того же жанра или схожие по тематике.

#### Почему Content-based?
- **Обоснование выбора**:
  - Отлично работает в сценариях поиска, так как учитывает содержимое фильмов.
  - Не требует пользовательских оценок, что решает проблему холодного старта для новых пользователей.
  - Легко масштабируется: при добавлении новых фильмов достаточно обновить индексацию.

#### Результат
- Модель эффективно формирует список фильмов, схожих с заданным, на основе их содержания.  
- Проверка показала, что рекомендации релевантны и совпадают с ожиданиями пользователей.

#### Результат (иллюстрации) 

![image](https://github.com/user-attachments/assets/653fb189-4cd8-43dd-8ae7-efeb225bacea)

1. **Исходный фильм**: В данном примере пользователем выбран фильм с `movieId = 296`, что соответствует фильму *Pulp Fiction (1994)*, как видно из таблицы ниже.
   
2. **Список рекомендаций**: 
 Для оценки релевантности рекомендаций можно рассмотреть предложенные фильмы:
   - **Reservoir Dogs (1992)** — режиссером этого фильма, как и *Pulp Fiction*, является Квентин Тарантино, что делает его релевантной рекомендацией для фанатов стиля этого режиссера.
   - **The Big Lebowski (1998)** — культовый фильм с элементами черного юмора и необычным повествованием. Хотя он не от того же режиссера, но схож с *Pulp Fiction* по тональности и подходу к диалогам.
   - **Léon: The Professional (1994)** — еще один культовый фильм 1990-х с напряженным сюжетом, сильными персонажами и отличной драматической составляющей. Хорошо дополняет список для любителей криминальных драм.
   - **Fight Club (1999)** — фильм с глубоким философским подтекстом, сложной сюжетной структурой и культом стиля 90-х. Вполне релевантен.
   - **La Femme Nikita (1990)** — фильм о криминальной среде, с напряженной драмой, который имеет схожие элементы с *Pulp Fiction*.
   - **The Hateful Eight (2015)** — фильм от того же режиссера (Квентин Тарантино), что напрямую делает его релевантным для фанатов.
   - **Django Unchained (2012)** — еще один фильм Тарантино с уникальным стилем повествования, юмором и криминальной драмой, что делает его идеально подходящим.
   - **Funny Games U.S. (2007)** — психологический триллер, который менее связан с *Pulp Fiction*, но может понравиться любителям напряженного и мрачного кинематографа.
   - **The Social Network (2010)** — рекомендация менее релевантна, поскольку это больше биографическая драма о технологическом стартапе, а не криминальная драма.
   - **In Bruges (2008)** — черная комедия с сильным криминальным сюжетом и необычными персонажами, что делает ее очень подходящей рекомендацией.

##### Итог
Большинство рекомендаций можно считать весьма релевантными, особенно те, которые связаны с фильмами Квентина Тарантино (*Reservoir Dogs*, *The Hateful Eight*, *Django Unchained*), а также культовые криминальные драмы и фильмы с черным юмором (*In Bruges*, *Fight Club*). Некоторые фильмы, такие как *The Social Network*, могут быть менее подходящими в этом контексте, но их включение может быть связано с особенностями модели (например, схожими ключевыми словами).

![image](https://github.com/user-attachments/assets/e8d228fd-8ab6-4d72-a13d-60dcaeb0e426)

### Оценка рекомендаций для фильма *The Lion King (1994)*

1. **Исходный фильм**: В примере используется фильм *The Lion King (1994)*, жанры которого включают "приключения", "анимация", "детский", "драма", "мюзикл", "воображение".

2. **Список рекомендаций**:
   - **Pete's Dragon (1977)** — семейный фильм с элементами приключений и фантазии, что соответствует жанрам *The Lion King*. Рекомендация релевантна.
   - **Dumbo (1941)** — анимационный фильм Disney, ориентированный на детей, с трогательной сюжетной линией. Подходит к характеристикам исходного фильма.
   - **Aladdin (1992)** — анимационный мюзикл Disney с приключениями и элементами воображения. Очень релевантен как по жанрам, так и по стилю.
   - **101 Dalmatians (1961)** — классический фильм Disney с акцентом на приключения и детей. Хорошо сочетается с *The Lion King*.
   - **The Jungle Book (1967)** — фильм, связанный с темами природы, приключений и животных. Практически идеальная рекомендация.
   - **The Fox and the Hound (1981)** — трогательная история о дружбе животных, которая перекликается с эмоциональными темами *The Lion King*. Рекомендация весьма релевантна.
   - **The Aristocats (1970)** — анимационный фильм о приключениях, ориентированный на детей. Тематически близок и релевантен.
   - **Beauty and the Beast (1991)** — анимационный мюзикл Disney с драматической сюжетной линией. Очень релевантная рекомендация.
   - **Alice in Wonderland (1951)** — приключения в мире фантазий, схожи с элементами воображения *The Lion King*. Рекомендация уместна.
   - **Snow White and the Seven Dwarfs (1937)** — первый анимационный фильм Disney, с похожими элементами сказочной драмы и мюзикла. Подходит как тематически, так и стилистически.

##### Итог
   Все предложенные фильмы можно считать высоко релевантными, поскольку они либо принадлежат студии Disney, либо имеют схожие жанровые характеристики, такие как "анимация", "приключения", "детский", "мюзикл". Модель демонстрирует отличные результаты в подборе рекомендаций, соответствующих запросу.

![image](https://github.com/user-attachments/assets/3a339a15-a77f-4dfc-9f31-c928609fffa4)

### Оценка рекомендаций для фильма *Léon: The Professional (1994)*

1. **Исходный фильм**: В примере используется фильм *Léon: The Professional (1994)*

2. **Список рекомендаций**:
   - **Femme Nikita, La (1990)** — фильм о наемной убийце с напряженным драматическим сюжетом. Очень схож по тематике и стилю с *Léon*. Рекомендация релевантна.
   - **Grosse Pointe Blank (1997)** — черная комедия с элементами боевика о профессиональном убийце. Хотя этот фильм более легкий по настроению, он пересекается с темой профессиональных убийц. Рекомендация умеренно релевантна.
   - **The Negotiator (1998)** — напряженный триллер с криминальной сюжетной линией и динамичным действием. Отличный выбор для поклонников *Léon*. Рекомендация релевантна.
   - **Taxi Driver (1976)** — культовый триллер-драма о социально отчужденном человеке с элементами насилия и напряжения. Идеально подходит как рекомендация по настроению и стилю.
   - **Infernal Affairs (2002)** — криминальная драма о мафиози и полицейских. Схожий напряженный тон и глубокая драма. Рекомендация уместна.
   - **The Bourne Ultimatum (2007)** — боевик с акцентом на шпионскую тему и динамику. Несмотря на отличие в жанре, фильм перекликается с *Léon* элементами боевика. Рекомендация умеренно релевантна.
   - **Serpico (1973)** — напряженная криминальная драма о борьбе с коррупцией в полиции. Хотя здесь нет профессиональных убийц, фильм подходит для поклонников криминального жанра. Рекомендация условно релевантна.
   - **Day of the Jackal (1973)** — триллер о наемном убийце с продуманным сюжетом. Очень близко по теме к *Léon*. Рекомендация релевантна.
   - **American Gangster (2007)** — криминальная драма, сосредоточенная на мафиози и преступном мире. Фильм схож жанрово, но не столь близок по сюжету. Рекомендация умеренно релевантна.
   - **In the Line of Fire (1993)** — триллер о защите президента, с элементами криминального жанра. Сюжетно не так близок, но может быть интересен любителям напряженных историй. Умеренно релевантно.

##### Итог
Рекомендации в целом достаточно релевантны исходному фильму, особенно такие фильмы, как *Femme Nikita, La (1990)*, *Taxi Driver (1976)*, *Day of the Jackal (1973)* и *The Negotiator (1998)*. Они разделяют ключевые элементы с *Léon*, такие как криминальный мир, напряжение и сильные персонажи. Менее релевантными выглядят фильмы вроде *The Bourne Ultimatum* и *In the Line of Fire*, которые отличаются по тематике и жанру, но все равно могут быть интересны поклонникам криминальных драм и боевиков.

## Сравнение моделей

| Модель           | Применение                | Преимущества                                                                                     | Метрика   | Результат  |
|-------------------|---------------------------|--------------------------------------------------------------------------------------------------|-----------|------------|
| **UserKNN**       | Персональные рекомендации | Высокая точность для активных пользователей; учитывает реальное поведение                        | NDCG@10   | **0.8465** |
| **Content-based** | Поиск и связанные фильмы   | Решает задачу поиска и рекомендации схожих фильмов; подходит для новых пользователей             | Ручная проверка | Высокая релевантность |

## Почему именно эти подходы?

1. **UserKNN**:
   - Эффективен для персонализированных рекомендаций, так как учитывает историю оценок пользователей.
   - Метрика NDCG@10 подтверждает, что модель формирует релевантные и полезные списки рекомендаций.

2. **Content-based**:
   - Необходим для задач поиска, так как позволяет находить фильмы, схожие с заданным.
   - Учитывает только содержимое фильмов, что делает модель независимой от пользовательских данных.

## Выводы
- **UserKNN** показал себя как высокоэффективная модель для формирования персонализированных рекомендаций. Метрика NDCG@10 подтверждает качество списка рекомендаций.
- **Content-based** — ключевое решение для задач поиска и формирования рекомендаций к конкретному фильму. Она позволяет гибко учитывать содержание фильмов, обеспечивая высокую релевантность.


